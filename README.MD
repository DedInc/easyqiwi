# EasyQiwi ü•ù

–ú–æ–¥—É–ª—å `easyqiwi` - –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π Python –º–æ–¥—É–ª—å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å QIWI API. –û–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç –ª–µ–≥–∫–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª QIWI –∫–æ—à–µ–ª—å–∫–∞ –≤ –≤–∞—à–∏ Python –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –° –ø–æ–º–æ—â—å—é `easyqiwi` –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ–ª—É—á–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –±–∞–ª–∞–Ω—Å —Å—á–µ—Ç–æ–≤, –∏—Å—Ç–æ—Ä–∏—é –ø–ª–∞—Ç–µ–∂–µ–π, –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å—á–µ—Ç–∞ –∏ –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ!

## –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è üë§
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç–∞–º–∏ üí≥
- –ü—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—Ä–∏–∏ –ø–ª–∞—Ç–µ–∂–µ–π üîç
- –°–æ–∑–¥–∞–Ω–∏–µ —Å—á–µ—Ç–æ–≤ –¥–ª—è –æ–ø–ª–∞—Ç—ã (–∏–Ω–≤–æ–π—Å–æ–≤) üßæ
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚öôÔ∏è
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—Ä–æ–∫—Å–∏ üåê
- –ï—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞–ø—Ç—á–∏ üîí
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å–µ—Å—Å–∏–∏ –≤ Selenium/Puppeteer –∏ —Ç.–¥. ü§ñ


## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

–ü—Ä–∏–º–µ—Ä –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `easyqiwi` –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ QIWI –∏ —Å–æ–∑–¥–∞–Ω–∏—è —Å—á–µ—Ç–∞ –¥–ª—è –æ–ø–ª–∞—Ç—ã:

```python
import asyncio
from easyqiwi import EasyQiwiAuthCore, EasyQiwiAPI, setup_proxy
from easyqiwi import AuthException

async def main():
    phone = '+79228133736'
    password = 'example'
    proxy_tuple = await setup_proxy('socks5', '162.210.192.136', '25881')

    qiwi = EasyQiwiAuthCore(phone, password, proxy_tuple)

    try:
        await qiwi.auth()
    except AuthException as e:
        print(e)
        exit()

    qiwi_api = EasyQiwiAPI(qiwi)
    p2p_resp = await qiwi_api.generate_p2p_public()
    p2p_key = p2p_resp['publicKey']
    widget_code = p2p_resp['widgetAliasCode']
    invoice_resp = await qiwi_api.create_invoice(p2p_key, widget_code, 100)
    invoice_uid = invoice_resp['invoice_uid']

    print(f'https://oplata.qiwi.com/form?invoiceUid={invoice_uid}')

    await qiwi.close()

if __name__ == '__main__':
    asyncio.run(main())
```

–í —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ –º—ã —Å–æ–∑–¥–∞–µ–º –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å QIWI, –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É–µ–º—Å—è –∏ —Å–æ–∑–¥–∞–µ–º —Å—á–µ—Ç –Ω–∞ –æ–ø–ª–∞—Ç—É –≤ 100 —Ä—É–±–ª–µ–π.

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å–µ—Å—Å–∏–∏

### Selenium

```python
import asyncio
from easyqiwi import EasyQiwiAuthCore
from easyqiwi import AuthException
from selenium import webdriver

async def main():
    phone = '+79228133736'
    password = 'example'

    qiwi = EasyQiwiAuthCore(phone, password)

    try:
        await qiwi.auth()
    except AuthException as e:
        pass

    cookies = qiwi.cookies
    auth_data = qiwi.auth_data

    await qiwi.close()

    driver = webdriver.Chrome()
    driver.get('https://qiwi.com/')

    driver.get('https://qiwi.com/')

    for cookie in cookies:
        driver.add_cookie({
            'name': cookie['name'],
            'value': cookie['value'],
            'domain': cookie['domain']
        })

    driver.execute_script(f"localStorage.setItem('oauth-token-head', '{auth_data}');")

    driver.get('https://qiwi.com/main')
    await asyncio.sleep(100)
    driver.quit()

if __name__ == '__main__':
    asyncio.run(main())
```

### Pyppeteer

```python
import asyncio
from easyqiwi import EasyQiwiAuthCore
from easyqiwi import AuthException
from pyppeteer import launch

async def main():
    phone = '+79228133736'
    password = 'example'

    qiwi = EasyQiwiAuthCore(phone, password)

    try:
        await qiwi.auth()
    except AuthException as e:
        pass

    cookies = qiwi.cookies
    auth_data = qiwi.auth_data

    await qiwi.close()

    browser = await launch(headless=False)
    pages = await browser.pages()
    page = pages[0]

    for cookie in cookies:
        await page.setCookie({'name': cookie['name'], 'value': cookie['value'], 'domain': cookie['domain']})

    await page.goto('https://qiwi.com/')
    await page.evaluate(f"localStorage.setItem('oauth-token-head', '{auth_data}')")
    await page.goto('https://qiwi.com/main')
    await asyncio.sleep(100)
    await browser.close()

if __name__ == '__main__':
    asyncio.run(main())
```


## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –º–æ–¥—É–ª—å `easyqiwi` –º–æ–∂–Ω–æ —á–µ—Ä–µ–∑ `pip`:

```bash
pip install easyqiwi
```

## –ù–µ–±–æ–ª—å—à–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

–ß—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å QIWI API, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é, –∏—Å–ø–æ–ª—å–∑—É—è –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –∏ –ø–∞—Ä–æ–ª—å –æ—Ç QIWI –∫–æ—à–µ–ª—å–∫–∞:

```python
qiwi = EasyQiwiAuthCore(phone, password)
await qiwi.auth()
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞–ø—Ç—á–∏

–ú–æ–∂–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–ø—Ç—á—É, –µ—Å–ª–∏ –æ–Ω–∞ –≤—ã—Å–∫–∞–∫–∏–≤–∞–µ—Ç:

```python
from easyqiwi import RecaptchaException

try:
	qiwi = EasyQiwiAuthCore(phone, password)
	await qiwi.auth()
except RecaptchaException as e:
	# –∏ —Ç—É—Ç –º–æ–∂–Ω–æ —Ä–µ—à–∞—Ç—å –∫–∞–ø—Ç—á—É –∏ –∑–∞—Ç–µ–º –≤—ã–∑–≤–∞—Ç—å
	await qiwi.auth(recaptcha='–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–∞—è –∫–∞–ø—Ç—á–∞')
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è

–ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:

```python
qiwi_api = EasyQiwiAPI(qiwi)
profile = await qiwi_api.get_current_profile()
print(profile)
```

### –ò—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π

–ü–æ–ª—É—á–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –ø–ª–∞—Ç–µ–∂–µ–π:

```python
payments = await qiwi_api.get_payments(person_id, rows=10)
print(payments)
```

### –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–≤–æ–π—Å–∞

–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ –∏–Ω–≤–æ–π—Å–∞ –¥–ª—è –æ–ø–ª–∞—Ç—ã:

```python
invoice_resp = await qiwi_api.create_invoice(p2p_key, widget_code, 500, comment='–ó–∞ —É—Å–ª—É–≥–∏')
invoice_uid = invoice_resp['invoice_uid']
print(f'–°—Å—ã–ª–∫–∞ –¥–ª—è –æ–ø–ª–∞—Ç—ã: https://oplata.qiwi.com/form?invoiceUid={invoice_uid}')
```

### –ó–∞–∫—Ä—ã—Ç–∏–µ —Å–µ—Å—Å–∏–∏

–ù–µ –∑–∞–±—É–¥—å—Ç–µ –∑–∞–∫—Ä—ã—Ç—å —Å–µ—Å—Å–∏—é –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —Ä–∞–±–æ—Ç—ã:

```python
await qiwi.close()
```

## –ü—Ä–æ–∫—Å–∏

–ï—Å–ª–∏ –≤–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–∫—Å–∏, –≤—ã –º–æ–∂–µ—Ç–µ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –µ–≥–æ —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

```python
proxy_tuple = await setup_proxy('socks5', 'proxy_ip', 'proxy_port', 'username', 'password')
```

## –î—Ä—É–≥–∏–µ –º–µ—Ç–æ–¥—ã API

–ü–æ–º–∏–º–æ –æ–ø–∏—Å–∞–Ω–Ω—ã—Ö –≤—ã—à–µ, `easyqiwi` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –¥–æ—Å—Ç—É–ø –∏ –∫ –¥—Ä—É–≥–∏–º –º–µ—Ç–æ–¥–∞–º QIWI API:

### –ò—Å—Ç–æ—á–Ω–∏–∫–∏ —Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏—è

–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ —Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:

```python
sources = await qiwi_api.get_sources(person_id)
```

### –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

–ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: 

```python  
identification = await qiwi_api.get_identification(person_id)
```

### –°—á–µ—Ç–∞

–ü–æ–ª—É—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã—Ö —Å—á–µ—Ç–æ–≤ –ø–æ –∏—Ö —Å—Ç–∞—Ç—É—Å–∞–º:

```python
checkouts = await qiwi_api.get_checkouts() 
```

### –ö–∞—Ä—Ç—ã

–ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–º –∫–∞—Ä—Ç–∞–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:

```python
cards = await qiwi_api.get_cards()
``` 

### –û–±—â–∞—è —Å—É–º–º–∞ –ø–ª–∞—Ç–µ–∂–µ–π

–ü–æ–ª—É—á–∏—Ç—å –æ–±—â—É—é —Å—É–º–º—É –≤—Ö–æ–¥—è—â–∏—Ö/–∏—Å—Ö–æ–¥—è—â–∏—Ö –ø–ª–∞—Ç–µ–∂–µ–π –∑–∞ –ø–µ—Ä–∏–æ–¥:

```python
total_payments = await qiwi_api.get_total_payments(person_id, start_date, end_date)
```

### –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è

–ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏:

```python
transaction = await qiwi_api.get_transactions(transaction_id) 
```